# [Low][Refactoring] Deduplicate enrich implementations\n\n## Summary\nThere are two enrich paths implementing overlapping logic:\n- src/commands/enrich.ts (cmdEnrich) — used by the CLI\n- src/enrich.ts (handleEnrich) — used directly by tests\n\nThese occasionally diverge (flags defaults, scanning order, error handling). This duplication increases drift risk and maintenance cost.\n\n## Recommendation\nRefactor to a single enrich implementation (e.g., consolidate into src/enrich.ts), exporting a uniform function that the CLI wraps. Keep the CLI command thin. Update tests and CLI to share the same core code path.\n\n## Rationale\n- Prevents behavior drift between CLI and programmatic usage\n- Simplifies testing and reduces surface for bugs\n- Eases future feature additions (e.g., mentions scanning options)\n\n## Acceptance Criteria\n- One authoritative enrich() implementation with complete flag handling\n- CLI command delegates to the shared function\n- Existing tests updated to target the unified implementation\n- No change in observable behavior (all current tests remain green)\n\nBy: validator-agent (validation note)\n
