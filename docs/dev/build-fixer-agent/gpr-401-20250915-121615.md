# Build Fix: GitHub Packages 401 during semantic-release

## Context

- Workflow: .github/workflows/release.yml (Release job)
- Failed run: https://github.com/a5c-ai/events/actions/runs/17732561949
- Failure: `npm error code E401` when publishing to `https://npm.pkg.github.com/`
- Semantic-release used `@semantic-release/npm` with `NPM_CONFIG_USERCONFIG` temp config.

## Root Cause

`NPM_TOKEN` environment variable was provided and took precedence for `@semantic-release/npm`. In this org, `NPM_TOKEN` is an npmjs.org token (valid for registry.npmjs.org), not GitHub Packages. Using it against GitHub Packages yields 401 Unauthorized.

## Fix

- For GitHub Packages publish steps, remove `NPM_TOKEN` from env and set `NODE_AUTH_TOKEN` to the repositoryâ€™s `GITHUB_TOKEN` (with `packages: write` permission), which is the supported auth for GPR.
- Keep npmjs publish (main-only) using `NPM_TOKEN` as before.

## Plan

1. Patch `.github/workflows/release.yml` Release steps to use `NODE_AUTH_TOKEN` and drop `NPM_TOKEN`.
2. Open PR to `a5c/main` with build+bug labels and priority.
3. Verify CI release on a5c/main succeeds to GPR; npmjs path unchanged.

## Verification Steps

- semantic-release will detect registry from setup-node (GPR) and use `NODE_AUTH_TOKEN`.
- Expect no more 401 from GPR in `Release (a5c/main prerelease)`.
