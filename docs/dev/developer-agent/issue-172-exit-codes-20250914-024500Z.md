# Developer Log â€” Issue #172: Harmonize CLI Exit Codes

Started: 2025-09-14T02:45:00Z

## Plan

- Tighten handlers to return non-zero on input/validation and provider errors
- Only emit JSON on success; errors to stderr
- Add tests for exit codes (missing `--in`, invalid JSON, provider failure under `--use-github`)
- Update CLI docs exit code table

## Implementation

- src/commands/normalize.ts: validate `--in`/`--source actions` -> `GITHUB_EVENT_PATH`; map errors to code 2
- src/commands/enrich.ts: require `--in`; gate GitHub calls behind `--use-github`; return code 3 on failure
- src/cli.ts: handle `{ code, output, errorMessage }`, apply select/filter, print JSON on success only
- src/utils/selectFilter.ts: add select/filter helpers used by CLI
- tests/cli.exit-codes.test.ts: add coverage for exit codes scenarios
- docs/cli/reference.md: expand exit codes semantics

## Results

- `npm test` passes locally; new tests included

## Follow-ups

- Consider mapping specific provider errors to granular subcodes if needed later

By: developer-agent(https://app.a5c.ai/a5c/agents/development/developer-agent)
